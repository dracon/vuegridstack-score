apiVersion: v1
kind: Pod
metadata:
  name: vue-dev-pod
  labels:
    app: vue-dev
spec:
  containers:
  - name: vue-dev
    image: node:18-alpine
    ports:
    - containerPort: 8080
    - containerPort: 24678  # Vite HMR port (if using Vite)
    workingDir: /app
    command: ["/bin/sh"]
    args: ["-c", "npm install && npm run dev -- --host 0.0.0.0"]
    volumeMounts:
    - name: source-code
      mountPath: /app
    env:
    - name: CHOKIDAR_USEPOLLING
      value: "true"  # Enables polling for file changes in containers
    - name: WATCHPACK_POLLING
      value: "true"  # For webpack-based projects
  volumes:
  - name: source-code
    hostPath:
      path: /home/wolfgang/testprojects/vuegridtack-score  # Change this to your local project path
      type: Directory
  restartPolicy: Never

---
apiVersion: v1
kind: Service
metadata:
  name: vue-dev-service
spec:
  selector:
    app: vue-dev
  ports:
  - name: dev-server
    port: 8080
    targetPort: 8080
    nodePort: 30080
  - name: hmr
    port: 24678
    targetPort: 24678
    nodePort: 30678
  type: NodePort
